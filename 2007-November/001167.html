<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Stgt-devel] No LUN option in target.c
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/stgt-devel/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:stgt-devel%40lists.berlios.de?Subject=Re%3A%20%5BStgt-devel%5D%20No%20LUN%20option%20in%20target.c&In-Reply-To=%3C474AC043.2090003%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001172.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Stgt-devel] No LUN option in target.c</H1>
    <B>Albert Pauw</B> 
    <A HREF="mailto:stgt-devel%40lists.berlios.de?Subject=Re%3A%20%5BStgt-devel%5D%20No%20LUN%20option%20in%20target.c&In-Reply-To=%3C474AC043.2090003%40gmail.com%3E"
       TITLE="[Stgt-devel] No LUN option in target.c">albert.pauw at gmail.com
       </A><BR>
    <I>Mon Nov 26 13:46:59 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001172.html">[Stgt-devel] No LUN option in target.c
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1167">[ date ]</a>
              <a href="thread.html#1167">[ thread ]</a>
              <a href="subject.html#1167">[ subject ]</a>
              <a href="author.html#1167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Tomasz,

I didn't use the device mounted, but you are right in clearing the 
caches. As told in the stuff I found on the internet regarding 
drop_caches a sync is necessary first.

Would it be an idea to create a test script using e.g disktest (on 
diskdevice), iozone (on filesystem) clearing the caches properly.

That way we can compare our own results better with others?

Albert

P.S. To be complete, the info on drop_caches I found on the internet:

Kernels 2.6.16 and newer provide a mechanism to have the kernel drop the 
page cache and/or inode and dentry caches on command, which can help 
free up a lot of memory. Now you can throw away that script that 
allocated a ton of memory just to get rid of the cache...

To use /proc/sys/vm/drop_caches, just echo a number to it.

To free pagecache:

# echo 1 &gt; /proc/sys/vm/drop_caches

To free dentries and inodes:

# echo 2 &gt; /proc/sys/vm/drop_caches

To free pagecache, dentries and inodes:

echo 3 &gt; /proc/sys/vm/drop_caches

As this is a non-destructive operation and dirty objects are not 
freeable, the user should run &quot;sync&quot; first!

&gt;<i> It is appropriate, when used appropriately.
</I>&gt;<i> 
</I>&gt;<i> If a block device is used (mounted, swap, md/dm etc.) it is also cached.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> One should always clear the cache if wants to measure performance (on 
</I>&gt;<i> the target, on the initiator, or both, depending on where the block 
</I>&gt;<i> device is used; to be 100% sure, clear the cache on both target and 
</I>&gt;<i> initiator before each test):
</I>&gt;<i> 
</I>&gt;<i> echo 3 &gt; /proc/sys/vm/drop_caches
</I>&gt;<i> 
</I>&gt;<i> 
</I>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001172.html">[Stgt-devel] No LUN option in target.c
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1167">[ date ]</a>
              <a href="thread.html#1167">[ thread ]</a>
              <a href="subject.html#1167">[ subject ]</a>
              <a href="author.html#1167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/stgt-devel">More information about the Stgt-devel
mailing list</a><br>
</body></html>
