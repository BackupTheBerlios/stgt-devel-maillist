<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Stgt-devel] User-mode iSER
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/stgt-devel/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:stgt-devel%40lists.berlios.de?Subject=Re%3A%20%5BStgt-devel%5D%20User-mode%20iSER&In-Reply-To=%3CD4F8F0B3820E754C887699BEF26A8940014CF87F%40taurus.voltaire.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000309.html">
   <LINK REL="Next"  HREF="000311.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Stgt-devel] User-mode iSER</H1>
    <B>Dan Bar Dov</B> 
    <A HREF="mailto:stgt-devel%40lists.berlios.de?Subject=Re%3A%20%5BStgt-devel%5D%20User-mode%20iSER&In-Reply-To=%3CD4F8F0B3820E754C887699BEF26A8940014CF87F%40taurus.voltaire.com%3E"
       TITLE="[Stgt-devel] User-mode iSER">danb at voltaire.com
       </A><BR>
    <I>Sun Aug  6 10:44:31 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000309.html">[Stgt-devel] User-mode iSER
</A></li>
        <LI>Next message: <A HREF="000311.html">[Stgt-devel] User-mode iSER
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#310">[ date ]</a>
              <a href="thread.html#310">[ thread ]</a>
              <a href="subject.html#310">[ subject ]</a>
              <a href="author.html#310">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> 

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A> 
</I>&gt;<i> [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A>] On Behalf Of 
</I>&gt;<i> FUJITA Tomonori
</I>&gt;<i> Sent: Sunday, August 06, 2006 11:05 AM
</I>&gt;<i> To: Dan Bar Dov
</I>&gt;<i> Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">fujita.tomonori at lab.ntt.co.jp</A>; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">mingz at ele.uri.edu</A>; 
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel at lists.berlios.de</A>; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">tom at opengridcomputing.com</A>
</I>&gt;<i> Subject: Re: [Stgt-devel] User-mode iSER
</I>&gt;<i> 
</I>&gt;<i> From: &quot;Dan Bar Dov&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">danb at voltaire.com</A>&gt;
</I>&gt;<i> Subject: Re: [Stgt-devel] User-mode iSER
</I>&gt;<i> Date: Sun, 6 Aug 2006 10:59:36 +0300
</I>&gt;<i> 
</I>&gt;<i> &gt;  
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A> 
</I>&gt;<i> &gt; &gt; [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A>] On Behalf Of 
</I>&gt;<i> &gt; &gt; FUJITA Tomonori
</I>&gt;<i> &gt; &gt; Sent: Thursday, August 03, 2006 6:20 PM
</I>&gt;<i> &gt; &gt; To: Dan Bar Dov
</I>&gt;<i> &gt; &gt; Cc: <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">mingz at ele.uri.edu</A>; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">fujita.tomonori at lab.ntt.co.jp</A>; 
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel at lists.berlios.de</A>; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">tom at opengridcomputing.com</A>
</I>&gt;<i> &gt; &gt; Subject: Re: [Stgt-devel] User-mode iSER
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; From: &quot;Dan Bar Dov&quot; &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">danb at voltaire.com</A>&gt;
</I>&gt;<i> &gt; &gt; Subject: Re: [Stgt-devel] User-mode iSER
</I>&gt;<i> &gt; &gt; Date: Thu, 3 Aug 2006 11:34:33 +0300
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt;  
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; &gt; From: <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A> 
</I>&gt;<i> &gt; &gt; &gt; &gt; [mailto:<A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel-bounces at lists.berlios.de</A>] On Behalf Of 
</I>&gt;<i> &gt; &gt; Ming Zhang
</I>&gt;<i> &gt; &gt; &gt; &gt; Sent: Wednesday, August 02, 2006 5:20 PM
</I>&gt;<i> &gt; &gt; &gt; &gt; To: Tom Tucker
</I>&gt;<i> &gt; &gt; &gt; &gt; Cc: FUJITA Tomonori; <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">stgt-devel at lists.berlios.de</A>
</I>&gt;<i> &gt; &gt; &gt; &gt; Subject: Re: [Stgt-devel] User-mode iSER
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; On Wed, 2006-08-02 at 09:01 -0500, Tom Tucker wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; [...snip...]
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; I think this is the area where we will need to get 
</I>&gt;<i> &gt; &gt; &gt; &gt; fancy if we want
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; higher performance. To avoid the copy, we would have to 
</I>&gt;<i> &gt; &gt; &gt; &gt; migrate to
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; netchannels (if they every happen) or implement our own 
</I>&gt;<i> &gt; &gt; &gt; &gt; simple tear-away
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; &gt; buffer scheme on top of a socket. I think this is 
</I>&gt;<i> &gt; &gt; &gt; &gt; phase-ii, however. 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; ok, otherwise copy to user space and copy back to kernel 
</I>&gt;<i> &gt; &gt; &gt; &gt; for disk = low
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; performance. yes, direct io can be used here, but then u 
</I>&gt;<i> &gt; &gt; &gt; &gt; lose whole
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; &gt; cache benefits.
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; &gt; Can you elaborate on the loss of &quot;whole cache benefits&quot;. 
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; &gt; if you use a Linux box as a storage server, it will be 
</I>&gt;<i> &gt; &gt; desired to use
</I>&gt;<i> &gt; &gt; &gt; &gt; page cache as storage cache. though this will bring 
</I>&gt;<i> data integrity
</I>&gt;<i> &gt; &gt; &gt; &gt; issues, but so many people still want to have it for specific
</I>&gt;<i> &gt; &gt; &gt; &gt; applications.
</I>&gt;<i> &gt; &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; I don't think page cache as storage cache makes sense. 
</I>&gt;<i> If you look
</I>&gt;<i> &gt; &gt; &gt; at the networked storage, you have caching on the initiator 
</I>&gt;<i> &gt; &gt; (client) side
</I>&gt;<i> &gt; &gt; &gt; and you have caching on the target (storage server) 
</I>&gt;<i> side. Storage
</I>&gt;<i> &gt; &gt; &gt; servers usually have write-behind cache, and the better 
</I>&gt;<i> ones, have
</I>&gt;<i> &gt; &gt; &gt; it battery backed up for data integrity's sake. Storage 
</I>&gt;<i> &gt; &gt; admins know to
</I>&gt;<i> &gt; &gt; &gt; shutd down write behind caching if it is not backed up.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Modern operating systems and applications (like file 
</I>&gt;<i> systems) does not
</I>&gt;<i> &gt; &gt; need help from battery-backed memory to enjoy 
</I>&gt;<i> write-behind cache on
</I>&gt;<i> &gt; &gt; SAN target devices for better performance without data corruption
</I>&gt;<i> &gt; &gt; risks. So page cache is always useful.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Since we are working on the SAN target, my point is we need 
</I>&gt;<i> to know if
</I>&gt;<i> &gt; this serving target is write-behind or not. If our code 
</I>&gt;<i> relies on page cache, 
</I>&gt;<i> &gt; it can not operate in any mode except write behind, however, this is
</I>&gt;<i> &gt; an implicit write behind. We could provide a faster 
</I>&gt;<i> response with an explicit 
</I>&gt;<i> &gt; write behind.
</I>&gt;<i> 
</I>&gt;<i> Sorry, I'm not sure what you mean. What does 'an implicit write
</I>&gt;<i> behind' mean?
</I>
It means that the target sends a response because from the target's code
point of view it wrote the data to storage, but since you use page cache, 
the data didn't actually get to storage.  The target code thinks it did a write-
through, but it actually got a write behind. 
An explicit write-behind would let the target send a response *before* it
wrote the data anywhere (even buffer cache). This explicit write behind is 
therefore faster.


&gt;<i> _______________________________________________
</I>&gt;<i> Stgt-devel mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/stgt-devel">Stgt-devel at lists.berlios.de</A>
</I>&gt;<i> <A HREF="http://bat.berlios.de/mailman/listinfo/stgt-devel">http://bat.berlios.de/mailman/listinfo/stgt-devel</A>
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000309.html">[Stgt-devel] User-mode iSER
</A></li>
	<LI>Next message: <A HREF="000311.html">[Stgt-devel] User-mode iSER
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#310">[ date ]</a>
              <a href="thread.html#310">[ thread ]</a>
              <a href="subject.html#310">[ subject ]</a>
              <a href="author.html#310">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/stgt-devel">More information about the Stgt-devel
mailing list</a><br>
</body></html>
